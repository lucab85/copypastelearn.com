# Replace YOUR_DOMAIN with your actual domain (e.g. copypastelearn.com)
# Caddy automatically provisions Let's Encrypt TLS certificates

YOUR_DOMAIN {
	# Web app
	reverse_proxy /api/labs/* labs:4000
	reverse_proxy web:3000

	# Security headers
	header {
		X-Content-Type-Options "nosniff"
		X-Frame-Options "DENY"
		Referrer-Policy "strict-origin-when-cross-origin"
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
	}

	# Gzip compression
	encode gzip zstd
}

# Redirect www â†’ apex
www.YOUR_DOMAIN {
	redir https://YOUR_DOMAIN{uri} permanent
}
